
name: 'Configuration des variables d'environnement'
description: 'Configure les variables d'environnement pour le déploiement'

inputs:
  openai-api-key:
    description: 'Clé API OpenAI'
    required: true
  google-cloud-project:
    description: 'ID du projet Google Cloud'
    required: true
  working-directory:
    description: 'Répertoire de travail'
    required: true

runs:
  using: 'composite'
  steps:
    - name: Configuration des variables d'environnement
      shell: bash
      working-directory: ${{ inputs.working-directory }}
      run: |
        echo "NODE_ENV=production" > .env
        
        if [ -n "${{ inputs.openai-api-key }}" ]; then
          echo "✅ Configuration de OPENAI_API_KEY"
          echo "OPENAI_API_KEY=${{ inputs.openai-api-key }}" >> .env
        else
          echo "❌ ERREUR: OPENAI_API_KEY manquante"
          exit 1
        fi
        
        echo "GOOGLE_CLOUD_PROJECT=${{ inputs.google-cloud-project }}" >> .env
        
        echo "Variables d'environnement configurées avec succès"
